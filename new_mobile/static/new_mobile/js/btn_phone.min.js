/*! meiqia 2015-11-09 */
!function(){var Dom={get:function(a,b){if(b=b||document,a.indexOf("#")>-1)a=a.replace("#",""),a=b.getElementById(a);else if(a.indexOf(".")>-1){var c="*",d=[];if(0!=a.indexOf(".")){var e=a.split(".");c=e[0],a=e[1]}else a=a.replace(".","");for(var f=b.getElementsByTagName(c),g=0,h=f.length;h>g;g++)for(var i=0,j=f[g].className.split(" "),k=j.length;k>i;i++)if(j[i]==a){d.push(f[g]);break}a=d}else a=b.getElementsByTagName(a);return a},css:function(a,b,c){a.style[b]=c},loadStyle:function(a){var b=document.createElement("style");b.type="text/css";try{b.appendChild(document.createTextNode(a))}catch(c){b.styleSheet.cssText=a}var d=document.getElementsByTagName("head")[0];d.appendChild(b)},on:function(a,b,c){a="string"==typeof a?document.getElementById(a):a,a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},show:function(a){a.style.display="block"}},Ajax={makeQuery:function(a){a=a||{};var b=[];a.__=(new Date).getTime();for(var c in a){var d=a[c];b.push(c+"="+encodeURIComponent(d))}var e=b.join("&").replace(/%20/g,"+");return e},post:function(a,b,c){var d=c.success||function(){},e=c.error||function(){},f=c.timeout||18e4,g=c.timeoutBack,h=null;if(!a)return null;var i=new XMLHttpRequest;i.open("post",a,!0),i.onreadystatechange=function(){if(4==i.readyState){i.onreadystatechange=function(){},clearTimeout(h);var a=i.responseText;i.status>=200&&i.status<300||304==i.status?d(a,i):e(a,i)}};var j=this.makeQuery(b);i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(j),h=setTimeout(function(){i&&(i.onreadystatechange=function(){},i.abort(),g())},f)},jsonp:function(a,b,c,d){d&&d.timeout&&setTimeout(function(){d.timeoutBack()},d.timeout);var e=this.makeQuery(b)+"&callback="+c,f=document.createElement("script");f.src=a+"?"+e;try{document.body.appendChild(f)}catch(g){}}},Color={blue:["#067ab4","#0c90c2"],gray:["#616161","#797979"],green:["#69b40f","#81c21d"],initial:["#47c1a8","#61cdb8"],red:["#f23f3f","#f45959"],rosered:["#ea4c89","#ee659d"],yellow:["#ff8000","#ff9500"],get:function(a){return a=a.toLowerCase(),this[a]}},Cookie={read:function(a,b){a=encodeURIComponent(a)+"=";var c=document.cookie,d=null,e=c.indexOf(a),f=c.indexOf(";",e),f=-1==f?c.length:f;return e>-1&&(d=c.substring(e+a.length,f),b||(d=decodeURIComponent(d))),d},set:function(a,b,c,d,e,f){var g=encodeURIComponent(a)+"=",h=new Array;switch(typeof b){case"object":for(var i in b)i.length>0&&b.hasOwnProperty(i)&&h.push(encodeURIComponent(i)+"="+encodeURIComponent(b[i]));h.length>0&&(g+=h.join("&"));break;default:g+=encodeURIComponent(b)}c||(c=new Date,c.setTime(c.getTime()+7776e6)),c instanceof Date&&(g+="; expires="+c.toGMTString()),d&&(g+="; path="+d),e&&(g+="; domain="+e),f&&(g+="; secure"),document.cookie=g}},Lang={html_encode:function(a){var b="";return 0==a.length?"":(b=a.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/\'/g,"&#39;"),b=b.replace(/\"/g,"&quot;"),b=b.replace(/\n/g,"<br>"))},trim:function(a){return"undefined"==typeof a?"":(a=a.replace(/^\s*/g,""),a.replace(/\s*$/g,""))}},getTitle=function(){return document.getElementsByTagName("title").length>0?document.getElementsByTagName("title")[0].innerHTML||"":""},parseQuerystring=function(a){if("string"!=typeof a)return{};if(a=a.trim(),""===a)return{};var b={};try{for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");e[0]&&e[1]&&(b[e[0]]=decodeURIComponent(e[1]))}}catch(f){}return b},mc_getReferrer=function(){var a="";if(location.search.length>1){var b=location.search.replace("?",""),c=parseQuerystring(b);if(c._realref_)return a=c._realref_}var d=document.getElementById("_realref_");return d&&(a=d.getAttribute("realref")||"",a.length>0)?a:document.referrer},Attr={tabid:"",source:"MB",unitid:_CONFIG.unitid,cookieKey:"MECHAT_BTNCKID",visitCNum:"MECHAT_VISITNUM",visitCKey:"MECHAT_VISITMSG",visitCHED:"MECHAT_VISITHEAD",visit_msg_num:0,visit_last_msg:"",visit_last_head:"",cookieVal:"",inviteUs:"",fromId:"",lp:window.location.href,title:getTitle(),referrer:document.referrer||"",dialPage:window.location.href||"",fromPage:mc_getReferrer()||"",hasOnlineUServer:!0,buttonStyle:"new",colorId:"initial",company:{uname:"",utel:"",uhead:"",ulogo:""},chatcnt:"",msgids:"",style:1,margins:[50,100],online_txt:"我们在线，点击对话",leave_txt:"给我们留言",lvmsg_txt:"",targetPage:"index.html",lvmsgChecks:{ismail:"true",ismsn:"true",isqq:"true",istel:"true"},ssl:"open",staff:_CONFIG.staff||"",group:_CONFIG.group||"",chatHtml:function(){return"local"==_CONFIG.version?"."+meiqia_ph+"/"+Attr.targetPage:_CONFIG.chatHost+meiqia_ph+"/"+Attr.targetPage},button:function(){return _CONFIG.statHost+"/unit/button"},metadata:function(){return _CONFIG.chatHost+"/set/attrs"},imgPath:function(){return _CONFIG.sHost+"/images/"},newTabid:function(){return Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)},getUrl:function(){return window.location.href},openChat:function(){var a="&_realref_="+encodeURIComponent(this.getUrl()),b="&cookie="+this.cookieVal+"&ssl="+Attr.ssl;this.delVisitMsg();var c=this.chatHtml()+"?unitid="+this.unitid+b+"&theme="+this.colorId+"&inviteUs="+this.inviteUs+"&fromId="+this.fromId+a;Attr.staff&&(c=c+"&staff="+Attr.staff),"undefined"!=typeof Attr.group&&""!=Attr.group&&(c=c+"&group="+Attr.group),window.location.href=c},saveVisitMsg:function(){this.visit_msg_num&&(Cookie.set(this.visitCNum,this.visit_msg_num),Cookie.set(this.visitCKey,this.visit_last_msg),this.visit_last_head&&Cookie.set(this.visitCHED,this.visit_last_head))},readVisitMsg:function(){this.visit_msg_num=Cookie.read(this.visitCNum)||0,this.visit_msg_num=parseInt(this.visit_msg_num),this.visit_last_msg=Cookie.read(this.visitCKey)||"",this.visit_last_head=Cookie.read(this.visitCHED)||""},delVisitMsg:function(){Cookie.set(this.visitCNum,null),Cookie.set(this.visitCKey,null),Cookie.set(this.visitCHED,null)},mRS:function(a){for(var b=[],c=0,d=0;a>d;d++)c=Math.floor(10*Math.random()),b.push(c.toString());return b.join("")},setHttpHost:function(){_CONFIG.chatHost=_CONFIG.httpChatHost,_CONFIG.statHost=_CONFIG.httpStatHost,_CONFIG.visitHost=_CONFIG.httpVisitHost,_CONFIG.wwwHost=_CONFIG.httpWwwHost,_CONFIG.sHost=_CONFIG.httpSHost}},Tel={button:function(a){var b={cookie:Attr.cookieVal||"",lp:Attr.lp,id:Attr.unitid,unitid:Attr.unitid,title:Attr.title,localr:Attr.referrer,source:Attr.source,fp:Attr.fromPage};Ajax.jsonp(Attr.button(),b,"mechat_btncb"),window.mechat_btncb=function(b){a(b)}},metadata:function(a){null!=a&&(a.unitid=Attr.unitid,a.cookie=Attr.cookieVal,a.source=Attr.source,Ajax.post(Attr.metadata(),a,{}))},visitPoll:function(callback,timeout,timeoutBack){var json={tabid:Attr.tabid,unitid:Attr.unitid,cookie:Attr.cookieVal,refuseChat:!1,url:Attr.lp,chatCnt:Attr.chatcnt,buttonStyle:Attr.buttonStyle,source:Attr.source};Attr.msgids&&(json.msgids=Attr.msgids);var url=_CONFIG.visitHost+"/visit/poll";Ajax.post(url,json,{success:function(d){try{d=eval("("+d+")"),callback(d)}catch(ex){timeoutBack()}},timeout:timeout,timeoutBack:timeoutBack,error:timeoutBack})}},MetadataModel={realName:"",sex:"",birthday:"",age:"",job:"",avatar:"",comment:"",appUserId:"",appUserName:"",appNickName:"",tel:"",email:"",address:"",QQ:"",weibo:"",weixin:"",appkey:"",from:"",extraParams:"",deviceBrand:"",deviceModel:"",os:"",osVersion:"",resolution:"",networkEnvironment:"",deviceToken:"",appVersion:"",osLanguage:"",osTimezone:"",filterProperty:function(a){var b=null;for(var c in a)this.hasOwnProperty(c)&&a[c]&&(b=null==b?{}:b,"extraParams"==c&&"object"==typeof a[c]?"undefined"!=typeof JSON&&(b.extraParams=JSON.stringify(a[c])):b[c]=a[c]);return b}},MBBtn={size:"10",color:"Initial",tel:"",style:"1",margins:[50,100],mcsure:"确定",image:"",popBtn:{}},Btn={css:"#MECHAT-BTN-1 .MECHAT_ARROW{width:12px;height:20px;position:absolute;top:50%;right:0;margin-top:-10px;background:url('"+Attr.imgPath()+"icon_mb@2x.png') 0 -40px no-repeat;background-size:40px auto}#MECHAT-BTN-1,#MECHAT-BTN-2{position:fixed;background:#00c8ab;z-index:2147483647;display:none;}#MECHAT-BTN-1{width:100%;left:0;bottom:0;opacity:.95;overflow:hidden;padding:10px 0;display:none;}#MECHAT-BTN-2{top:50%;right:15px;width:40px;height:40px;padding:1px;border-radius:50%;}#MECHAT-BTN-1 .MECHAT_BAR_tb{display:table;margin:0 auto;max-width:80%;height:40px}#MECHAT-BTN-1 .MECHAT_BAR_cell{position:relative;display:table-cell;vertical-align:middle;padding-left:55px;padding-right:24px;color:#fff;font-size:14px}#MECHAT-BTN-1 .MECHAT_BAR_CHAT{position:absolute;top:50%;left:0;margin-top:-20px}#MECHAT-BTN-2 .MECHAT_FLOAT_CHAT,#MECHAT-BTN-1 .MECHAT_BAR_CHAT{display:inline-block;overflow:hidden;border-radius:50%;width:40px;height:40px}#MECHAT-BTN-1 .MECHAT_TIPS,#MECHAT-BTN-2 .MECHAT_TIPS{position:absolute;display:inline-block;left:30px;top:-5px;background:#f00;min-width:14px;height:14px;padding:2px;line-height:14px;text-align:center;font-size:12px;border-radius:50px;color:#fff;display:none;}#MECHAT-SOUND{width:0;height:0;position:absolute;top:0;left:0;}.mechat-color-default{background-color:#36afa5;background-image:-webkit-linear-gradient(top,#36afa5,#3f887f);background-image:linear-gradient(top,#36afa5,#3f887f)}.mechat-color-gray{background-color:#bdbdbd;background-image:-webkit-linear-gradient(top,#bdbdbd,#8a8a8a);background-image:linear-gradient(top,#bdbdbd,#8a8a8a)}.mechat-color-blue{background-color:#5082db;background-image:-webkit-linear-gradient(top,#5082db,#206a9c);background-image:linear-gradient(top,#5082db,#206a9c)}.mechat-color-green{background-color:#17bd36;background-image:-webkit-linear-gradient(top,#17bd36,#2d7d4d);background-image:linear-gradient(top,#17bd36,#2d7d4d)}.mechat-color-red{background-color:#e51818;background-image:-webkit-linear-gradient(top,#e51818,#911);background-image:linear-gradient(top,#e51818,#911)}.mechat-color-purple{background-color:#e260a0;background-image:-webkit-linear-gradient(top,#e260a0,#93177b);background-image:linear-gradient(top,#e260a0,#93177b)}.mechat-color-orange{background-color:#eb9317;background-image:-webkit-linear-gradient(top,#eb9317,#a56506);background-image:linear-gradient(top,#eb9317,#a56506)}",html:'<div id="MECHAT-BTN-1"><div class="MECHAT_BAR_tb"><div class="MECHAT_BAR_cell"><span style="color:#fff;font-size:16px;line-height: 20px;">我们在线，点击对话</span><span class="MECHAT_BAR_CHAT"><img src="'+Attr.imgPath()+'icon_mb@2x.png" alt="" width="40px" height="60px"/></span><span class="MECHAT_TIPS">1</span><span class="MECHAT_ARROW"></span></div></div></div><div id="MECHAT-BTN-2"><span class="MECHAT_FLOAT_CHAT"><img src="'+Attr.imgPath()+'icon_mb@2x.png" alt="" width="40px" height="60px"/></span><span class="MECHAT_TIPS">1</span></div>',mobileChatButton:{css:function(a){var b={0:"position:fixed; top:100px; right:0px",1:"position:fixed; bottom:0px; right:0px; height:60px",2:"position:fixed; right:"+MBBtn.margins[0]+"px; bottom:"+MBBtn.margins[1]+"px",3:" max-width:320px; max-height:40px;margin:0 auto ",4:"position:fixed; top:130px; right:0px"};return b[a]},html:function(a){var b={0:'<a id="_mc_jump" href="javascript:void(0);" target="_blank"><img border="0" src="'+_CONFIG.sHost+MBBtn.image+'" /></a>',1:'<a id="_mc_jump" href="javascript:void(0);"><img border="0" src="'+_CONFIG.sHost+"/images/button-widget/fan"+MBBtn.color+'.png" style="width: 60px"/></a>',2:'<a id="_mc_jump" href="javascript:void(0);"><img border="0" style="width:'+MBBtn.size+"px;height:"+MBBtn.size+'px;" src="'+_CONFIG.sHost+"/images/button-widget/round"+MBBtn.color+'.png" /></a>',3:'<img border="0" src="'+_CONFIG.sHost+'/images/button-widget/lump.png" style="width:100%;"/><div style="clear:both"></div><a href="tel:'+MBBtn.tel+'" style="display:block;position:absolute;top:0;left:0;width:50%;height:100%;"></a><span id="_mc_jump" style="display:block;position:absolute;top:0;right:0;width:50%;height:100%"></span>',4:'<a id="_mc_jump" href="javascript:void(0);" target="_blank"><img border="0" src="'+_CONFIG.sHost+"/images/button-widget/right"+MBBtn.color+'.png" border="0" style="width: 35px;height:115px;"/></a>'};return b[a]}}},View=function(){var a=new Object;return a.init=function(){a.create()},a.create=function(){Dom.loadStyle(Btn.css);var a=document.createElement("div");a.innerHTML=Btn.html,document.body.appendChild(a)},a.createBtn=function(){2==Attr.style?(a.btnObj=new BarBtn,a.btnObj.init()):1==Attr.style&&(a.btnObj=new FloatBtn,a.btnObj.init()),3==Attr.style&&(a.btnObj=new createMobileChatButton,a.btnObj.init()),Attr.readVisitMsg(),Attr.visit_msg_num>0&&Attr.visit_last_msg.length>0&&setTimeout(function(){Attr.visit_msg_num--,a.btnObj.newMsg(Attr.visit_last_msg,Attr.visit_last_head)},100)},a.setColor=function(){a.btnObj&&a.btnObj.setColor()},a.updateBtn=function(){a.btnObj&&a.btnObj.updateBtn()},a.newMsg=function(b,c,d){a.btnObj&&(c.length>0&&c.indexOf("http")<0&&(c=_CONFIG.wwwHost+c),a.btnObj.newMsg(b,c,d),Attr.visit_last_msg=b,c&&c.length>1&&(Attr.visit_last_head=c),Attr.saveVisitMsg())},a.setVisitMsg=function(){a.btnObj&&a.btnObj.setVisitMsg()},a},BarBtn=function(){var a=new Object;return a.init=function(){a.btn=Dom.get("#MECHAT-BTN-1"),a.btnHeight=a.btn.offsetHeight,a.msg=Dom.get("span",a.btn)[0],a.head=Dom.get("span.MECHAT_BAR_CHAT",a.btn)[0],a.head_df=a.head.innerHTML,a.tips=Dom.get("span.MECHAT_TIPS",a.btn)[0],a.arrow=Dom.get("span.MECHAT_ARROW")[0],Dom.show(a.btn),Dom.on(a.btn,"click",function(){Attr.openChat()}),navigator.userAgent.indexOf("IEMobile")>-1&&(Dom.css(a.head,"margin-top","-10px"),Dom.css(a.arrow,"margin-top","0")),Attr.hasOnlineUServer?a.updateBtn():a.setVisitMsg(),document.body.style.marginBottom=document.body.style.marginBottom+60+"px"},a.setColor=function(){var b=Color.get(Attr.colorId);b&&Dom.css(a.btn,"background",b[0])},a.updateBtn=function(){a.setCon(Attr.online_txt)},a.setCon=function(b){b.length>30&&(b=b.substring(0,30),b+="..."),a.msg.innerHTML=b},a.setTips=function(){Attr.visit_msg_num++,a.tips.innerHTML=Attr.visit_msg_num>99?"99+":Attr.visit_msg_num,Dom.show(a.tips)},a.setHead=function(b){a.head.innerHTML=b},a.setVisitMsg=function(){a.head_df='<img src="'+Attr.imgPath()+'leave.png" alt="" width="100%" height="100%" />',a.setHead(a.head_df),a.setCon(Attr.leave_txt)},a.newMsg=function(b,c){if(a.setTips(),a.setCon(b),c&&c.length>1){var d='<img src="'+c+'" alt="" width="100%" height="100%" />';a.setHead(d)}},a.noMsg=function(){a.setCon(Attr.online_txt),Attr.visit_msg_num=0,a.setHead(a.head_df)},a},FloatBtn=function(){var a=new Object;return a.init=function(){a.btn=Dom.get("#MECHAT-BTN-2"),a.head=Dom.get("span.MECHAT_FLOAT_CHAT",a.btn)[0],a.head_df=a.head.innerHTML,a.tips=Dom.get("span.MECHAT_TIPS",a.btn)[0],Dom.show(a.btn),Attr.hasOnlineUServer||a.setVisitMsg(),Dom.on(a.btn,"click",function(){Attr.openChat()})},a.setColor=function(){var b=Color.get(Attr.colorId);b&&Dom.css(a.btn,"background",b[0]);var c=-(40+parseInt(Attr.margins[1]));Dom.css(a.btn,"right",Attr.margins[0]+"px"),Dom.css(a.btn,"top","100%"),Dom.css(a.btn,"margin-top",c+"px")},a.setVisitMsg=function(){a.head_df='<img src="'+Attr.imgPath()+'leave.png" alt="" width="100%" height="100%" />',a.setHead(a.head_df)},a.setHead=function(b){a.head.innerHTML=b},a.setTips=function(){Attr.visit_msg_num++,a.tips.innerHTML=Attr.visit_msg_num>99?"99+":Attr.visit_msg_num,Dom.show(a.tips)},a.newMsg=function(b,c){if(a.setTips(),c&&c.length>1){var d='<img src="'+c+'" alt="" width="100%" height="100%" />';a.setHead(d)}},a.noMsg=function(){Attr.visit_msg_num=0,Dom.hide(a.tips)},a},createMobileChatButton=function(){var a,b=new Object;b.init=function(){var b=Btn.mobileChatButton;MBBtn.color=Attr.colorId.toLowerCase();var d=document.createElement("div");if(d.className="mc_button",d.innerHTML=b.html(MBBtn.style),d.style.cssText=b.css(MBBtn.style),d.style.zIndex=2147483647,"3"==MBBtn.style){a=document.createElement("div"),a.innerHTML=d.outerHTML,document.body.clientWidth,a.style.cssText="z-index:2147483647;position:fixed;left:0; bottom:0;height:40px;width:100%;background-image:url("+_CONFIG.sHost+"/images/button-widget/lump"+MBBtn.color+"bg.png);",document.body.appendChild(a),document.body.style.marginBottom=document.body.style.marginBottom+40+"px";var e=Dom.get("#_mc_jump");e&&Dom.on(e,"click",function(a){return Attr.openChat(),a.preventDefault()})}else{var f=parseInt(MBBtn.style);f>=0&&5>f&&document.body.appendChild(d);var g=Dom.get(".mc_button")[0];g&&Dom.on(g,"click",function(a){return Attr.openChat(),a.preventDefault()})}var h=parseInt(MBBtn.popBtn.delay)||4;setTimeout(function(){c(MBBtn.popBtn)},1e3*h)};var c=function(a){var b=MBBtn.color,c="color-default";c="initial"==b?"color-default":"blue"==b?"color-blue":"gray"==b?"color-gray":"green"==b?"color-green":"red"==b?"color-red":"rosered"==b?"color-purple":"color-orange",c="mechat-"+c;var f={};if("1"==a["switch"]||"true"==a["switch"]){if("self"==a.location){f=e();var g=a.selfBtn;if("string"==typeof g)try{g=JSON.parse(g)}catch(h){}var i=Dom.get(".mccustominvitor",f)[0];g&&g.path&&(i.style.backgroundImage=0===g.path.indexOf("url")?g.path:"url("+_CONFIG.sHost+g.path+")");var j=Dom.get(".mcsure",f)[0];j.style.top=g.sureTop,j.style.left=g.sureLeft;var k=Dom.get(".mccancel",f)[0];k.style.top=g.cancelTop,k.style.left=g.cancelLeft}else{f=d(c);var l=Dom.get(".invitorBtnContent",f);l[0].textContent=a.content;var l=Dom.get(".mcsure",f);l[0].textContent=MBBtn.mcsure||""}var m=Dom.get(".mccancel")[0];Dom.on(m,"click",function(){Dom.css(f,"display","none");var b=parseInt(a.time)||50;setTimeout(function(){f.style.display="inherit"},1e3*b)});var n=Dom.get(".mcsure")[0];Dom.on(n,"click",function(){Attr.openChat()})}return f},d=function(a){var b="position:fixed; width:100%; height:115px; left:0; top:32%; color:#000; z-index:9999",c='<div class="mcinvitor" style="width:240px;height:100%;margin:auto;background:#fff;border-radius:10px;-webkit-box-shadow:rgba(0, 0, 0, 0.498039) 0px 0px 20px;-moz-box-shadow:rgba(0, 0, 0, 0.498039) 0px 0px 20px;box-shadow:rgba(0, 0, 0, 0.498039) 0px 0px 20px;"><div style="height:30%;position:relative"><img border="0" class="mccancel" border="0" src="'+_CONFIG.sHost+'/image/centerclose.png" style="position:absolute;right:0;height:20px;width:20px;" /></div><div class="invitorBtnContent" style="font-size:16px;margin:5px 5px 18px 5px;text-align:center"></div><div style="position:absolute;bottom:13px"><button type="button" class="mcsure '+a+'" style="color:#fff;background-color:#25b2a2;border:transparent;text-shadow:0 -1px 0 rgba(0, 0, 0, 0.25);border-radius:4px;padding:4px 20px;text-align:center;height:30px;line-height:24px;font-size:16px;margin:0 0 0 84px" ></button></div></div>',d=document.createElement("div");return d.innerHTML=c,d.style.cssText=b,document.body.appendChild(d),d},e=function(){var a="position:fixed; width:100%; height:120px; top:32%; color:#000; z-index:9999",b='<div class="mcinvitor mccustominvitor" style="width:240px;height:100%;margin:auto;position:relative;"><div class="mcsure" style="width:80px;height:50px;position:absolute;"></div><div class="mccancel" style="width:50px;height:30px;position:absolute;"></div></div>',c=document.createElement("div");return c.innerHTML=b,c.style.cssText=a,document.body.appendChild(c),c},f=function(a,b){Attr.visit_msg_num++;var c=Dom.get("#MC_wrapInviteDiv");c&&document.body.removeChild(c);var d="width:100%;bottom:0px;max-width:320px;height:40px;margin:0 auto;position:relative;",e="<span id='countdown' style='color:rgb(141, 141, 141);margin:5px;margin-left:50px;line-height:32px;font-size:18px;display:inline-block;float:left'>3</span><span class='mc_inviteContent' style='color: #468847;line-height:41px;font-size:16px;width:200px;overflow:hidden;display:inline-block;'>"+a+"</span><img id='mcrefuse' src='"+_CONFIG.sHost+"/image/centerclose.png' style='position:absolute;right:0;width:20px;height:20px;padding:10px;display:inline-block' />",f=document.createElement("div");f.className="mc_invite_chat",f.innerHTML=e,f.style.cssText=d,f.style.zIndex=21474836;var g=document.createElement("div");g.id="MC_wrapInviteDiv",g.innerHTML=f.outerHTML,document.body.clientWidth,g.style.cssText="z-index:2147483647;position:fixed;left:0; bottom:0;height:40px;width:100%;background:#dff0d8;border: 1px solid #d6e9c6;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;",document.body.appendChild(g);var h=Dom.get("#countdown");if("us_invite"==b)var i=3,j=setInterval(function(){i--,h.innerHTML=i,0==i&&clearInterval(j)},1e3),k=setTimeout(function(){Attr.openChat(),document.body.removeChild(g)},3e3);else h.innerHTML="";var l=Dom.get(".mc_inviteContent")[0];l&&Dom.on(l,"click",function(){Attr.openChat(),document.body.removeChild(g)});var m=Dom.get("#mcrefuse");Dom.on(m,"click",function(){clearTimeout(k),document.body.removeChild(g)})};return b.newMsg=function(a,b,c){f(a,c)},b.setColor=function(){},b},Contr=function(){var a=new Object,b=new View,c=new Visit(a);return a.getView=function(){return b},a.init=function(){!function(){if("function"==typeof getMeChatPartnerUserID){var a=getMeChatPartnerUserID();if("object"==typeof a&&null!=a&&a.hasOwnProperty("userId")){var b=a.userId;b&&"undefined"!=b&&(Attr.cookieVal=Lang.html_encode(Lang.trim(b)))}}if(!Attr.cookieVal){var c=Cookie.read(Attr.cookieKey);c&&"undefined"!=c&&(Attr.cookieVal=c)}}(),b.init(),a.button(),window.mechatClick=function(a){Attr.openChat(),"function"==typeof a&&a()}},a.sendMetadata=function(a){if(a&&"object"==typeof a){var b=MetadataModel.filterProperty(a);Tel.metadata(b)}},a.buttonCb=function(d){d.success&&(Attr.cookieVal=d.cookie,Attr.cookieVal&&"undefined"!=Attr.cookieVal&&"null"!=Attr.cookieVal||(Attr.cookieVal="006600"+(new Date).getTime().toString()+Attr.mRS(5)),a.readBtnData(d),b.createBtn(),c.init(),b.setColor()),Cookie.set(Attr.cookieKey,Attr.cookieVal),a.resetHref(),window.mechatMetadata=function(b){a.sendMetadata(b)},window.toChat=function(){Attr.openChat()}},a.button=function(){"object"==typeof BtnData?a.buttonCb(BtnData):Tel.button(function(b){a.buttonCb(b)})},a.objLength=function(a){var b=0;for(var c in a)b++;return b},a.readBtnData=function(b){b.ssl&&"0"==b.ssl&&"http:"==location.protocol&&(Attr.ssl="close",Attr.setHttpHost()),Attr.chatcnt=b.chatCnt||Attr.chatcnt,0==a.objLength(b.mb_button)||b.ubutton&&1==b.ubutton.check?(Attr.style=3,Attr.buttonStyle="old",MBBtn.image=b.ubutton.image||MBBtn.image,MBBtn.size=b.ubutton.size,b.ubutton.margins&&(MBBtn.margins=b.ubutton.margins.split(",")),Attr.colorId=b.ubutton.color||Attr.colorId,Attr.colorId=Attr.colorId.toLowerCase(),MBBtn.style=b.ubutton.style,MBBtn.popBtn=b.popBtn,MBBtn.mcsure=b.mcsure):b.mb_button&&(Attr.style=b.mb_button.style||Attr.style,_CONFIG.btn&&"hide"==_CONFIG.btn&&(Attr.style=3),Attr.colorId=b.mb_button.color||Attr.colorId,Attr.colorId=Attr.colorId.toLowerCase(),Attr.status=b.mb_button.status||Attr.status,b.mb_button.margins&&(Attr.margins=b.mb_button.margins.split(",")),Attr.online_txt=b.mb_button.online||Attr.online_txt,Attr.leave_txt=b.mb_button.leave||Attr.leave_txt),void 0!=typeof b.unitHasOnlineUServer&&("false"==b.unitHasOnlineUServer||0==b.unitHasOnlineUServer)&&(Attr.hasOnlineUServer=!1),b.utel&&(MBBtn.tel=b.utel),Attr.targetPage=Attr.hasOnlineUServer?"index.html":"ticket.html"},a.visitMsg=function(a){b.newMsg(a.content,a.usavatar,a.type),"us_invite"==a.type&&"new"==Attr.buttonStyle&&setTimeout(window.mechatClick,3e3),a.fromId&&"us_invite"==a.type?(Attr.inviteUs=a.fromId,Attr.fromId=""):(Attr.fromId=a.fromId,Attr.inviteUs="")},a.setHref=function(a,b){if(a&&b){var c=b.split("?")[0],d=(c.split("chat/")[1]||"").split("/")[1],e=b.split("?")[1],f=parseQuerystring(e);d&&(f.staff=d);var g="&_realref_="+encodeURIComponent(Attr.getUrl()),h="&cookie="+Attr.cookieVal,i=Attr.chatHtml()+"?unitid="+Attr.unitid+"&theme="+Attr.colorId+"&";for(var j in f)i=i+j+"="+f[j]+"&";i=i+h+g,a.setAttribute("href",i)}},a.resetHref=function(){var b=["meiqia.com/chat/","mobilechat/chat/","mechat.im/chat/","mechatim.com/chat/","mobilechat.im/chat/"],c=function(c){for(var d=document.getElementsByTagName(c),e=0,f=d.length;f>e;e++){var g=d[e];if(g&&g.getAttribute){var h=g.getAttribute("href");if(h)for(var i=0,j=b.length;j>i;i++){var k=b[i];if(h.indexOf(k)>=0){a.setHref(g,h);break}}}}};c("a"),c("area")},a},Visit=function(a){var b=new Object;return b.init=function(){"552bc91d4eae35d76b000009"!==Attr.unitid&&"553af79d4eae353c2f000001"!==Attr.unitid&&"846"!==Attr.unitid&&b.poll()},b.poll=function(){Tel.visitPoll(function(c){if(c.success&&c.msgs){var c=c.msgs[0];("us_normal"==c.type||"us_image"==c.type||"us_invite"==c.type)&&(Attr.msgids=c._id,a.visitMsg(c)),setTimeout(function(){b.poll()},100)}else setTimeout(function(){b.poll()},3e3)},3e4,function(){Attr.msgids="",setTimeout(function(){b.poll()},1e3)})},b};!function(){Attr.tabid=Attr.newTabid();var a=new Contr;a.init()}()}();